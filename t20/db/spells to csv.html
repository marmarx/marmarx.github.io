<!DOCTYPE html>
<html>
<title>Assigned array to CSV Spreadsheet</title>
<meta name="author" content="Marco Martins">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv=”Content-Type” content=”text/html; charset=utf-8″>
<script type="text/javascript" src="../db/spells.txt"></script>

<body><button onclick="exportToCsv()">export to CSV</button></body>

<script>
exportToCsv = function(){
 var CsvString = "";
 
 for (var lvl in spells){
  for (var title in spells[lvl]){
   CsvString += spells[lvl][title]['nome'] + '\t';
   CsvString += spells[lvl][title]['tipo'] + '\t';
   CsvString += spells[lvl][title]['circulo'] + '\t';
   CsvString += spells[lvl][title]['escola'] + '\t';
   CsvString += spells[lvl][title]['execucao'] + '\t';
   CsvString += spells[lvl][title]['alcance'] + '\t';
   CsvString += spells[lvl][title]['alvo'] + '\t';
   CsvString += spells[lvl][title]['area'] + '\t';
   CsvString += spells[lvl][title]['duracao'] + '\t';
   CsvString += spells[lvl][title]['resistencia'] + '\t';
   CsvString += spells[lvl][title]['descricao'] + '\t';
   var length = (Object.keys(spells[lvl][title]).length - 11)/2;
   for (var i=1;i<=length;i++){
    CsvString += spells[lvl][title]["add"+i] + '\t';
    CsvString += spells[lvl][title]["mod"+i] + '\t';
   }
   CsvString += '\r\n';
  }
 }
 
 console.log(CsvString);
 CsvString = "data:application/csv," + encodeURIComponent(CsvString);
 var x = document.createElement("A");
 x.setAttribute("href", CsvString );
 x.setAttribute("download","somedata.csv");
 document.body.appendChild(x);
 x.click();
}
</script>
</html>