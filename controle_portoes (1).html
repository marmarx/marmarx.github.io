<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Controle de Port천es</title>
<style>
  body { font-family: Arial; padding: 20px; }
  .gate {
    border: 1px solid #ccc;
    padding: 12px;
    margin-bottom: 10px;
    border-radius: 6px;
  }
  .open { background: #ffd6d6; }
  .closed { background: #d6ffd6; }
  button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .door {
    height: 10px;
    background: #333;
    margin: 8px 0;
    transform-origin: left;
    transition: transform 3s linear;
  }
  .open-door { transform: rotateY(80deg); }
  .closed-door { transform: rotateY(0deg); }
</style>

</head>
<body>

<h2>Controle de Port천es</h2>
<div id="gates"></div>

<script>
const gates = [
  { id: 1, local: "Entrada A", condominio: "Residencial Sol", fechado: true, conflitos: [2] },
  { id: 2, local: "Entrada B", condominio: "Residencial Sol", fechado: true, conflitos: [1] },
  { id: 3, local: "Garagem", condominio: "Residencial Lua", fechado: true, conflitos: [] }
]

function getGate(id) {
  return gates.find(g => g.id === id)
}

function hasOpenConflict(gate) {
  return gate.conflitos.some(cid => {
    const c = getGate(cid)
    return c && c.fechado === false
  })
}

function canOpen(gate) {
  if (!gate.fechado) return true
  return !hasOpenConflict(gate)
}

function toggleGate(id) {
  const gate = getGate(id)

  if (gate.fechado) {
    if (!canOpen(gate)) {
      alert("Existe um port찾o em conflito aberto.")
      return
    }
    gate.fechado = false
  } else {
    gate.fechado = true
  }

  render()
}

function render() {
  const container = document.getElementById("gates")
  container.innerHTML = ""

  gates.forEach(gate => {
    const conflictOpen = hasOpenConflict(gate)

    const div = document.createElement("div")
    div.className = `gate ${gate.fechado ? "closed" : "open"}`

    const btn = document.createElement("button")
    btn.textContent = gate.fechado ? "Abrir" : "Fechar"
    btn.onclick = () => toggleGate(gate.id)

    if (gate.fechado && conflictOpen) {
      btn.disabled = true
      btn.title = "Conflito com port찾o aberto"
    }

    div.innerHTML = `<div class="door ${gate.fechado ? "closed-door" : "open-door"}"></div>
      <strong>${gate.condominio}</strong><br>
      Local: ${gate.local}<br>
      Status: ${gate.fechado ? "Fechado" : "Aberto"}<br>
      Conflitos: ${gate.conflitos.join(", ") || "Nenhum"}<br><br>
    `

    div.appendChild(btn)
    container.appendChild(div)
  })
}

render()
</script>

</body>
</html>
